package server;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.ServerSocket;
import java.net.Socket;
import java.nio.channels.SocketChannel;

public class server {

	public static void main(String[] args) throws IOException {

		ServerSocket server_socket = null;
		Socket soc = null;
		int open_socket_num = 1245;

		while (true){
			System.out.println("server is running");
			server_socket = new ServerSocket(open_socket_num);
			soc = server_socket.accept();//기다리다 연결되면 accept통해 만들어지는 것이 클라이언트 소켓 

			System.out.println("client is admitted");
			System.out.println("server 정보 : "+soc.getLocalSocketAddress());
			System.out.println("client 정보 : "+soc.getRemoteSocketAddress());

			if (server_socket !=null){
				System.out.println("server socket 정보 : " + server_socket.toString());
				
				BufferedReader br = new BufferedReader(new InputStreamReader(soc.getInputStream()));
				
				InputStream is = socket.getInputStream(); 
				InputStreamReader isr = new InputStreamReader(is); 

				BufferedReader br = new BufferedReader(isr); 

				
				while(true){
					System.out.println("111");
					String str_from_client= br.readLine();
					System.out.println("222");
					System.out.println("client message : "+str_from_client);
				}
			}
		}
	}
}
