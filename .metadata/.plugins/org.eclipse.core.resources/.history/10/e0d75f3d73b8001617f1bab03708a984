package server_obj;
import java.sql.*;

public class DB_obj {
	
		static Connection conn = null;
		static PreparedStatement pstmt = null;
		static ResultSet rs = null;
		
		static String url = null;
		static String id = "dbtmddus";
		static String pw = "134652";
		
		public DB_obj(){
		
		}
		
		public void connect(){
			try{
				Class.forName("oracle.jdbc.driver.OracleDriver");
				System.out.println("driver load success");
				
				try{
					url = "jdbc:oracle:thin:@127.0.0.1:1521:XE";	
					//http://onoctober.tistory.com/54
					conn = DriverManager.getConnection(url, id, pw);
					System.out.println("db connect success");
					
						}
				catch (SQLException e){
					System.out.println(e);
				}
			}
			catch(ClassNotFoundException e){
				System.out.println(e);
			}
		}
		

		public void exec(String str_query){
			try{
				String sql = str_query;
				//"SELECT * FROM login_test";
				
				pstmt = conn.prepareStatement(sql);
				//pstmt.setString(1, x);
				rs = pstmt.executeQuery();
				//System.out.println(rs.next());
				while (rs.next()){
					System.out.println("name : " + rs.getString("NAME"));
					System.out.println("name : " + rs.getInt("password"));
				}
				rs.close();
				pstmt.close();					
			}
			catch (SQLException e){
				e.printStackTrace();
			}
			/*********************************************************************************/				
	}
		public void disconnect() throws SQLException{
			conn.close();
		}

}
