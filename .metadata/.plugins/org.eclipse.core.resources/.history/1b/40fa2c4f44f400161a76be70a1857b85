import java.io.BufferedReader;
import java.io.File;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;
import java.net.UnknownHostException;
import java.nio.charset.Charset;
import java.util.Vector;


public class read_file_and_dir_reverse {

	public static void main(String[] args) throws UnknownHostException, IOException {
		read_one_line();
	}

	public static void read_one_line() throws IOException{

		//서버측.
		/***********************************************************************/
		String server_StrDir = ".\\qwe";
		File server_file = new File(server_StrDir+"\\dd.txt");		
		Vector<String> server_ChattingRecord = new Vector<String>(0);
		BufferedReader server_br = new BufferedReader(new FileReader(server_file));
		String line;
		while ((line = server_br.readLine()) != null) {
			server_ChattingRecord.add(line);
		}
		//for (int i=v.size()-1; i>=0; i++){	//역순으로 보내고
		///	send (v.elementAt(i))
		//}
		server_br.close();
		/***********************************************************************/

		String client_StrDir = ".\\qwe";
		File client_file = new File(server_StrDir+"\\dd.txt");		

		Vector<String> client_ChattingRecord = new Vector<String>(0);
		BufferedReader client_br = new BufferedReader(new FileReader(client_file));
		String line2;
		while ((line2 = client_br.readLine()) != null) {
			client_ChattingRecord.add(line);
		}

		String receive_str;
		Vector<String> str_will_be_added = new Vector<String>(0);
		for (int i=server_ChattingRecord.size()-1; i>=0; i++){	//뒤에서부터, 최대 서버 txt크기만큼 받고
			receive_str = server_ChattingRecord.elementAt(i); //listen
			if(!client_ChattingRecord.contains(receive_str)){	//string은 이걸로 안될 수 있음.
				str_will_be_added.add(receive_str);
			}else{
				break;	//하나라도 읽은거 나오면 중단
			}
		}

		for(int i=str_will_be_added.size()-1; i>=0; i--){
			record_txt( str_will_be_added.elementAt(i));
		}

	}	

	public static void record_txt(String str) throws IOException{
		//File f = new File("C:\\Users\\dbtmddus\\Desktop\\qwerty\\dd.txt");		
		File f = new File(".\\qwerty\\dd.txt");		

		String ss = f.getParentFile().toString();
		System.out.println(ss);
		new File(ss).mkdirs();

		FileOutputStream f_out = new FileOutputStream(f, true);
		//FileOutputStream f_out = new FileOutputStream(f, false);
		f_out.write(str.getBytes(Charset.forName("EUC-KR")));	//EUC-KR-윈도우, UTF-8 리눅스.
		f_out.close();
	}	

}
